<div class = 'container'>
  <h2 class = 'my-5'>注文履歴詳細</h2>
   <div class = 'row'>
    <% if @order.present? %>
      <strong>注文情報</strong>
        <table class="table">
         <tbody>
          <tr>
            <th>注文日</th>
            <td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
          </tr>

          <tr>
            <th>配達先</th>
            <td><%= "〒" + @order.zip + "  " + @order.address + "  " + @order.name  %></td>
          </tr>

          <tr>
            <th>支払方法</th>
            <td><%= @order.payment_method_i18n %></td>
          </tr>

          <tr>
            <th>ステータス</th>
            <td><%= @order.status_i18n %></td>
          </tr>
        </tbody>
      </table>

    <strong>請求情報</strong>
    <table class="table">
      <tbody>
        <tr>
        <th>商品合計</th>
        <td><%= @order.total_price.to_s(:delimited) %>円</td>
      </tr>

      <tr>
        <th>配送料</th>
        <td><%= @order.postage %>円</td>
      </tr>

      <tr>
        <th><strong>ご請求額</strong></th>
        <td><%= (@order.total_price + @order.postage).to_s(:delimited) %>円</td>
      </tr>
      </tbody>
    </table>

    <strong>注文内容</strong>
      <table class="table">
      <thead>
        <tr>
          <th>商品</th>
          <th>単価（税込）</th>
          <th>個数</th>
          <th>小計</th>
          <td></td>
        </tr>
      </thead>

      <tbody>
      <% @order_items.each do |order_item| %>
        <tr>
          <td><%= order_item.product.name %></td>
          <td><%= order_item.product.add_tax_price.to_s(:delimited) %>円</td>
          <td><%= order_item.product_count %>個</td>
          <td>
            <% total = 0 %>
            <% subtotal = (order_item.product.add_tax_price*order_item.product_count).to_i %>
            <%= subtotal.to_s(:delimited) %>円 <% total += subtotal %>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
    <% else %>
    <p class = 'container'>注文履歴がありません。</p>
    <% end %>
   </div>
</div>